<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZTA - Gallery</title>

<style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:Arial;}
    body{
        background:url("assets/background.jpg") no-repeat center center fixed;
        background-size:cover;
        color:white;
        min-height:100vh;
    }

    /* NAVBAR */
    .navbar{
        width:100%;
        padding:25px 60px;
        display:flex;
        justify-content:space-between;
        align-items:center;
        backdrop-filter:blur(10px);
        background:rgba(0,0,0,0.35);
        position:sticky;top:0;z-index:999;
    }
    .logo{font-size:32px;font-weight:bold;letter-spacing:3px;}
    nav a{
        margin-left:25px;color:white;text-decoration:none;font-size:17px;
    }
    nav a:hover{color:#ff5050;}

    /* GALLERY GRID */
    .gallery{
        margin:40px auto;width:90%;
        display:grid;
        grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
        gap:20px;
    }
    .gallery img{
        width:100%;height:200px;object-fit:cover;border-radius:10px;
        cursor:pointer;border:2px solid rgba(255,255,255,0.4);
        transition:.3s;
    }
    .gallery img:hover{transform:scale(1.03);border-color:#ff5050;}

    /* POPUP */
    .popup-bg{
        position:fixed;top:0;left:0;width:100%;height:100%;
        background:rgba(0,0,0,0.8);
        display:none;justify-content:center;align-items:center;
        padding:20px;
    }
    .popup{
        width:90%;max-width:600px;background:rgba(0,0,0,0.85);
        border-radius:12px;padding:15px;
    }
    .popup img{width:100%;border-radius:10px;}

    .like-btn{cursor:pointer;font-size:20px;margin-top:10px;}

    .comments-box{
        max-height:170px;overflow-y:auto;margin-top:10px;padding-right:10px;
    }
    .comment-item{
        padding:6px;border-bottom:1px solid rgba(255,255,255,0.2);
    }

    .close-btn{
        margin-top:10px;width:100%;padding:10px;
        background:#ff5050;border:none;border-radius:6px;
        color:white;font-size:16px;cursor:pointer;
    }
</style>
</head>

<body>

<header class="navbar">
    <div class="logo">ZTA</div>
    <nav>
        <a href="index.html">About Me</a>
        <a href="gallery.html">Gallery</a>
        <a href="mission.html">Mission</a>
        <a href="shop.html">Gear</a>
        <a href="contact.html">Contact</a>
        <a href="auth.html" class="btn-login">Login</a>
    </nav>
</header>

<section class="gallery" id="gallery"></section>

<!-- POPUP -->
<div class="popup-bg" id="popupBG">
    <div class="popup">
        <img id="popupImg">

        <span class="like-btn" onclick="toggleLike()">❤️ 
            <span id="likeCount">0</span>
        </span>

        <div class="comments-box" id="commentsBox"></div>

        <input type="text" id="commentInput" placeholder="Add comment..." style="width:100%;padding:7px;margin-top:10px;">
        <button onclick="addComment()" class="close-btn">Add Comment</button>
        <button class="close-btn" onclick="closePopup()">Close</button>
    </div>
</div>

<script>
let photos = [];
let currentIndex = 0;

// AUTO LOAD IMAGES FROM assets/gallery
async function loadImages() {
    // MANUAL PATTERN (works on all static hosting)
    for (let i = 1; i <= 200; i++) {
        let path = `assets/gallery/photo${i}.jpg`;

        let exists = await fetch(path, { method: "HEAD" }).then(r => r.ok).catch(() => false);
        if (exists) photos.push({ src: path, likes: 0, comments: [] });
    }

    renderGallery();
}

// RENDER GALLERY
function renderGallery() {
    const gallery = document.getElementById("gallery");
    gallery.innerHTML = "";

    photos.forEach((pic, i) => {
        let img = document.createElement("img");
        img.src = pic.src;
        img.onclick = () => openPopup(i);
        gallery.appendChild(img);
    });
}

loadImages();

// OPEN POPUP
function openPopup(i){
    currentIndex = i;

    document.getElementById("popupImg").src = photos[i].src;
    document.getElementById("likeCount").innerText = photos[i].likes;

    loadComments();

    document.getElementById("popupBG").style.display = "flex";
}

// CLOSE POPUP
function closePopup(){
    document.getElementById("popupBG").style.display = "none";
}

// LIKE
function toggleLike(){
    photos[currentIndex].likes++;
    document.getElementById("likeCount").innerText = photos[currentIndex].likes;
}

// LOAD COMMENTS
function loadComments(){
    let box = document.getElementById("commentsBox");
    box.innerHTML = "";

    photos[currentIndex].comments.forEach(c=>{
        let div = document.createElement("div");
        div.className="comment-item";
        div.innerText=c;
        box.appendChild(div);
    });
}

// ADD COMMENT
function addComment(){
    let text = document.getElementById("commentInput").value.trim();
    if(!text) return;

    photos[currentIndex].comments.push(text);
    document.getElementById("commentInput").value="";
    loadComments();
}
</script>

</body>
</html>
